(function(t){function e(e){for(var r,o,a=e[0],c=e[1],u=e[2],f=0,p=[];f<a.length;f++)o=a[f],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&p.push(i[o][0]),i[o]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);l&&l(e);while(p.length)p.shift()();return s.push.apply(s,u||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],r=!0,a=1;a<n.length;a++){var c=n[a];0!==i[c]&&(r=!1)}r&&(s.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},i={app:0},s=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var a=window["webpackJsonp"]=window["webpackJsonp"]||[],c=a.push.bind(a);a.push=e,a=a.slice();for(var u=0;u<a.length;u++)e(a[u]);var l=c;s.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"14d9":function(t,e,n){"use strict";var r=n("2232"),i=n.n(r);i.a},"21bb":function(t,e,n){"use strict";var r=n("7a98"),i=n.n(r);i.a},2232:function(t,e,n){},5146:function(t,e,n){},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var r=n("2b0e"),i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("router-view")],1)},s=[],o=(n("5c0b"),n("2877")),a={},c=Object(o["a"])(a,i,s,!1,null,null,null),u=c.exports,l=n("8c4f"),f=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"home"},[n("TopMenu"),!t.song&&t.notListening?n("div",{staticClass:"home__not-listening"},[t._v("\n      You're signed in, but not listening to anything.\n    ")]):t._e(),t.fetchingLyrics?n("div",{staticClass:"home__status"},[t._v("\n      Fetching lyrics...\n      "),n("p",[t._v("for "),n("span",[t._v("\n        "+t._s(t.song.trackName)+"\n      ")]),t._v(" by "),n("span",[t._v("\n        "+t._s(t.song.artist)+"\n      ")])])]):t._e(),!t.fetchingLyrics&&t.song&&t.song.isPlaying?n("div",{staticClass:"home__lyrics"},[n("Karaoke"),n("ProgressBar")],1):t._e()],1)},p=[],g=(n("8e6e"),n("ac6a"),n("456d"),n("96cf"),n("3b8d")),h=n("bd86"),d=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"top-menu"},[n("ul",[n("li",[n("a",{on:{click:function(e){return t.showModal("about")}}},[t._v("About")])]),n("li",[n("a",{on:{click:function(e){return t.showModal("privacy")}}},[t._v("Privacy")])]),t._m(0)]),n("div",{staticClass:"modal-container",class:{hidden:""===t.modal}},[n("div",{staticClass:"modal-close"},[t._v("[x]")]),n("div",{staticClass:"modal about",class:{visible:"about"===t.modal}}),n("div",{staticClass:"modal privacy",class:{visible:"privacy"===t.modal}})])])},y=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("li",[n("a",{attrs:{href:"/logout"}},[t._v("Logout")])])}],v={data:function(){return{modal:""}},methods:{showModal:function(t){this.modal=t}}},b=v,m=(n("a97a"),Object(o["a"])(b,d,y,!1,null,"06f602ac",null)),O=m.exports,_=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.song&&t.song.isPlaying?n("div",{staticClass:"karaoke"},[n("div",{staticClass:"gradient top"}),t.lyrics?n("div",{staticClass:"karaoke__lyrics",domProps:{innerHTML:t._s(t.parsedLyrics)}}):t._e(),n("div",{staticClass:"gradient"})]):t._e()},j=[],w=(n("a481"),n("2f62"));function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function k(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){Object(h["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var L={name:"Karaoke",data:function(){return{artist:null,trackName:null}},computed:k({},Object(w["c"])(["song","lyrics"]),{parsedLyrics:function(){return!!this.lyrics&&this.lyrics.replace(/\n/g,"<br>")}})},S=L,C=(n("14d9"),Object(o["a"])(S,_,j,!1,null,"44fa471b",null)),T=C.exports,x=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.song&&t.song.isPlaying?n("div",{staticClass:"progress-bar"},[n("div",{staticClass:"progress-bar__title"},[t._v(t._s(t.title))]),n("div",{staticClass:"progress-bar__progress",style:{width:t.progress+"%"}},[t._v("\n    Â \n  ")])]):t._e()},E=[];function $(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function D(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$(Object(n),!0).forEach((function(e){Object(h["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var M={computed:D({},Object(w["c"])(["song"]),{progress:function(){var t=this.song.progress,e=this.song.duration,n=t/e*100;return Math.round(n)},title:function(){return"".concat(this.song.artist," - ").concat(this.song.trackName)}})},N=M,I=(n("dee8"),Object(o["a"])(N,x,E,!1,null,null,null)),q=I.exports;function K(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function A(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?K(Object(n),!0).forEach((function(e){Object(h["a"])(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):K(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}var B={name:"home",components:{TopMenu:O,Karaoke:T,ProgressBar:q},data:function(){return{queryTimer:null,notListening:!0,fetchingSong:!1,fetchingLyrics:!1}},computed:A({},Object(w["c"])(["song","lyrics"]),{isLoggedIn:function(){return this.$cookies.get("loggedIn")}}),methods:A({},Object(w["b"])(["setUser"]),{checkTrack:function(){var t=Object(g["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return console.log("checkTrack"),t.prev=1,t.next=4,this.$store.dispatch("getCurrentSong");case 4:t.next=10;break;case 6:t.prev=6,t.t0=t["catch"](1),console.log("failed"),window.location="/logout";case 10:case"end":return t.stop()}}),t,this,[[1,6]])})));function e(){return t.apply(this,arguments)}return e}(),startTimer:function(t){var e=this;this.isLoggedIn&&(this.queryTimer=setInterval((function(){e.isLoggedIn&&e.checkTrack()}),t))}}),beforeMount:function(){this.checkTrack()},mounted:function(){this.isLoggedIn||this.$router.push({path:"login"}),this.startTimer(2e3)},watch:{song:{immediate:!0,handler:function(t){var e=this;t?t.artist&&t.trackName&&t.artist!==this.artist&&t.trackName!==this.trackName&&(this.startTimer(6e3),this.notListening=!1,this.artist=t.artist,this.trackName=t.trackName,this.fetchingLyrics=!0,this.$store.dispatch("getLyrics",{query:"".concat(this.song.artist," ").concat(this.song.trackName)}).then((function(){e.fetchingLyrics=!1}))):(console.log("no song is currently playing"),this.notListening=!0,this.fetchingSong=!1,this.fetchingLyrics=!1,this.startTimer(2e3))}}}},F=B,J=(n("21bb"),Object(o["a"])(F,f,p,!1,null,null,null)),R=J.exports,H=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},U=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"signin"},[n("h1",[t._v("Spotify Karaoke")]),n("h3",[t._v("Instant lyrics for whatever you're listening to!")]),n("div",{staticClass:"signin-login"},[n("a",{attrs:{href:"/auth/spotify"}},[n("button",{attrs:{href:"/auth/spotify"}},[n("span",[t._v("Sign in With Spotify")])])])]),n("div",{staticClass:"signin-info"},[n("p",[t._v("\n      Note: by signing into this site with your Spotify account,\n      we will receive absolutely\n      "),n("i",[t._v("no")]),t._v(" personal information. The only permission scope\n      required for this service is\n      "),n("b",[n("a",{attrs:{href:"https://developer.spotify.com/documentation/general/guides/scopes/#user-read-playback-state",target:"_blank"}},[t._v("user-read-playback-state")])]),t._v("\n      for the purpose of fetching the song you are currently listening to. For more\n      information, please see the rest of the\n      "),n("a",{attrs:{href:"https://developer.spotify.com/documentation/general/guides/scopes/",target:"_blank"}},[t._v("Spotify API documentation")]),t._v(".\n    ")])])])}],W=(n("cfd8"),{}),Y=Object(o["a"])(W,H,U,!1,null,"092e2420",null),z=Y.exports;r["a"].use(l["a"]);var G=new l["a"]({routes:[{path:"/",name:"home",component:R},{path:"/login",name:"login",component:z}]}),Q=(n("7f7f"),n("bc3a")),V=n.n(Q);r["a"].use(w["a"]);var X={song:null,lyrics:null},Z={setSong:function(t,e){var n=e.song;r["a"].set(t,"song",n)},setLyrics:function(t,e){var n=e.lyrics;r["a"].set(t,"lyrics",n)}},tt={getCurrentSong:function(t){var e=t.commit;return new Promise((function(t,n){V.a.get("/api/getCurrentSong").then((function(r){var i=r.data;if(i.err)return n(i.err);var s,o=i.result.body;s=o.is_playing?{album:o.item.album.name,artist:o.item.artists[0].name,trackName:o.item.name,progress:o.progress_ms,duration:o.item.duration_ms,isPlaying:!0}:null,e("setSong",{song:s}),t()})).catch((function(t){e("setSong",{song:{isPlaying:!1}})}))}))},getLyrics:function(t,e){var n=t.commit,r=e.query;return n("setLyrics",{lyrics:""}),V.a.get("/api/getLyrics?query=".concat(r)).then((function(t){var e=t.data,r=e.lyrics;if(!r)throw new Error;n("setLyrics",{lyrics:r})})).catch((function(){n("setLyrics",{lyrics:null})}))}},et=new w["a"].Store({state:X,mutations:Z,actions:tt}),nt=n("2b27"),rt=n.n(nt);r["a"].config.productionTip=!1,r["a"].use(rt.a),new r["a"]({router:G,store:et,render:function(t){return t(u)}}).$mount("#app")},"57d3":function(t,e,n){},"5c0b":function(t,e,n){"use strict";var r=n("e332"),i=n.n(r);i.a},"7a98":function(t,e,n){},a580:function(t,e,n){},a97a:function(t,e,n){"use strict";var r=n("a580"),i=n.n(r);i.a},cfd8:function(t,e,n){"use strict";var r=n("5146"),i=n.n(r);i.a},dee8:function(t,e,n){"use strict";var r=n("57d3"),i=n.n(r);i.a},e332:function(t,e,n){}});
//# sourceMappingURL=app.05d63e09.js.map